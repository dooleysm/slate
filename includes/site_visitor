<h1 id="site-visitors">Site Visitors</h1>

<p>A Site has visitors and the information of those visitors can be fetched and updated programatically by means of the following endpoints.</p>

<h2 id="get-sites-site_id-visitors-visitor_id">GET <code class="prettyprint">/sites/{site_id}/visitors/{visitor_id}</code></h2>
<pre class="highlight shell"><code>curl --include <span class="se">\</span>
     --header <span class="s2">"Authorization: Token </span><span class="nv">$token</span><span class="s2">"</span> <span class="se">\</span>
     --header <span class="s2">"Accept: application/vnd.salemove.v1+json"</span> <span class="se">\</span>
  <span class="s2">"https://api.salemove.com/sites/</span><span class="nv">$siteId</span><span class="s2">/visitors/</span><span class="nv">$visitorId</span><span class="s2">"</span>
</code></pre>
<pre class="highlight ruby"><code><span class="c1">#!/usr/bin/env ruby</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'rest-client'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">token</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">strip</span>
<span class="n">site_id</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span>
<span class="n">visitor_id</span><span class="o">=</span><span class="no">ARGV</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nf">strip</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">:authorization</span> <span class="o">=&gt;</span> <span class="s2">"Token </span><span class="si">#{</span><span class="n">token</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
  <span class="ss">:accept</span> <span class="o">=&gt;</span> <span class="s1">'application/vnd.salemove.v1+json'</span>
<span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="no">RestClient</span><span class="p">.</span><span class="nf">get</span> <span class="s2">"https://api.salemove.com/sites/</span><span class="si">#{</span><span class="n">site_id</span><span class="si">}</span><span class="s2">/visitors/</span><span class="si">#{</span><span class="n">visitor_id</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>  <span class="n">headers</span>
<span class="nb">puts</span> <span class="n">response</span><span class="p">.</span><span class="nf">body</span>
</code></pre>

<blockquote>
<p>Generates the output</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.salemove.com/sites/ba02c995-5079-4adc-a0b8-819e7f301091/visitors/bb40afd7-7f65-4869-93ea-48a61c783aba"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7378742833"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"note"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"custom_attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bb40afd7-7f65-4869-93ea-48a61c783aba"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>It fetches the visitor&rsquo;s information with id <code class="prettyprint">visitor_id</code> for the site with id <code class="prettyprint">site_id</code>. The operator whose API Token is used for making the request should have rights on the site.</p>

<h2 id="put-sites-site_id-visitors-visitor_id">PUT <code class="prettyprint">/sites/{site_id}/visitors/{visitor_id}</code></h2>
<pre class="highlight shell"><code>curl --include <span class="se">\</span>
     --request PUT <span class="se">\</span>
     --header <span class="s2">"Authorization: Token </span><span class="nv">$token</span><span class="s2">"</span> <span class="se">\</span>
     --header <span class="s2">"Accept: application/vnd.salemove.v1+json"</span> <span class="se">\</span>
     --data-binary <span class="s2">"{
</span><span class="se">\"</span><span class="s2">name</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">John</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">email</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">test@email.com</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">phone</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">55443322</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">note</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">some random dude</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">note_update_method</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">append</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">custom_attributes</span><span class="se">\"</span><span class="s2">: {
  </span><span class="se">\"</span><span class="s2">These are custom fields, which you can define yourself. Those shown below are just examples</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">...</span><span class="se">\"</span><span class="s2">,
  </span><span class="se">\"</span><span class="s2">home_address</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">Winston</span><span class="se">\"</span><span class="s2">,
  </span><span class="se">\"</span><span class="s2">vip</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">true</span><span class="se">\"</span><span class="s2">
}
}"</span> <span class="se">\</span>
<span class="s2">"https://api.salemove.com/sites/</span><span class="nv">$siteId</span><span class="s2">/visitors/</span><span class="nv">$visitorId</span><span class="s2">"</span>
</code></pre>
<pre class="highlight ruby"><code><span class="c1">#!/usr/bin/env ruby</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'rest-client'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="n">token</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">strip</span>
<span class="n">site_id</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span>
<span class="n">visitor_id</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nf">strip</span>

<span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">name: </span><span class="s2">"John"</span><span class="p">,</span>
  <span class="ss">email: </span><span class="s2">"test@email.com"</span><span class="p">,</span>
  <span class="ss">phone: </span><span class="s2">"55443322"</span><span class="p">,</span>
  <span class="ss">note: </span><span class="s2">"some random dude"</span><span class="p">,</span>
  <span class="ss">note_update_method: </span><span class="s2">"append"</span><span class="p">,</span>
  <span class="ss">custom_attributes: </span><span class="p">{</span>
    <span class="ss">home_address: </span><span class="s2">"Winston"</span><span class="p">,</span>
    <span class="ss">vip: </span><span class="s2">"true"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">:authorization</span> <span class="o">=&gt;</span> <span class="s2">"Token </span><span class="si">#{</span><span class="n">token</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
  <span class="ss">:accept</span> <span class="o">=&gt;</span> <span class="s1">'application/vnd.salemove.v1+json'</span>
<span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="no">RestClient</span><span class="p">.</span><span class="nf">put</span> <span class="s2">"https://api.salemove.com/sites/</span><span class="si">#{</span><span class="n">site_id</span><span class="si">}</span><span class="s2">/visitors/</span><span class="si">#{</span><span class="n">visitor_id</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">values</span><span class="p">.</span><span class="nf">to_json</span><span class="p">,</span> <span class="n">headers</span>
<span class="nb">puts</span> <span class="n">response</span><span class="p">.</span><span class="nf">body</span>
</code></pre>

<blockquote>
<p>Generates the output</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.salemove.com/sites/ba02c995-5079-4adc-a0b8-819e7f301091/visitors/bb40afd7-7f65-4869-93ea-48a61c783aba"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@email.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"55443322"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some random dude"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"custom_attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"home_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Winston"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"vip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bb40afd7-7f65-4869-93ea-48a61c783aba"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>It updates the visitor&rsquo;s information with id <code class="prettyprint">visitor_id</code> for the site with id <code class="prettyprint">site_id</code>. The operator whose API token is used for making the request should have rights on the site.</p>

<table><thead>
<tr>
<th>Paramter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">site_id</code></td>
<td><code class="prettyprint">string</code></td>
<td>Yes</td>
<td>The site id whose visitor&rsquo;s information will be updated</td>
</tr>
<tr>
<td><code class="prettyprint">visitor_id</code></td>
<td><code class="prettyprint">string</code></td>
<td>Yes</td>
<td>The visitor whose information will be updated</td>
</tr>
<tr>
<td><code class="prettyprint">name</code></td>
<td><code class="prettyprint">string</code></td>
<td>No</td>
<td>The visitor&rsquo;s name</td>
</tr>
<tr>
<td><code class="prettyprint">email</code></td>
<td><code class="prettyprint">string</code></td>
<td>No</td>
<td>The visitor&rsquo;s email</td>
</tr>
<tr>
<td><code class="prettyprint">phone</code></td>
<td><code class="prettyprint">string</code></td>
<td>No</td>
<td>The visitor&rsquo;s phone</td>
</tr>
<tr>
<td><code class="prettyprint">note</code></td>
<td><code class="prettyprint">string</code></td>
<td>No</td>
<td>The visitor&rsquo;s notes.</td>
</tr>
<tr>
<td><code class="prettyprint">note_updated_method</code></td>
<td><code class="prettyprint">enum</code></td>
<td>No</td>
<td>Specifies a method for updating the visitor&rsquo;s note. The default value is <code class="prettyprint">replace</code>. Available values are <code class="prettyprint">replace</code> and <code class="prettyprint">append</code>. If the method is <code class="prettyprint">replace</code> then the notes for the visitor will be overwriten by the field <code class="prettyprint">note</code> in the request. If the method is <code class="prettyprint">append</code> then the field <code class="prettyprint">note</code> in the request will append to the existing visitor&rsquo;s notes.</td>
</tr>
<tr>
<td><code class="prettyprint">custom_attributes</code></td>
<td><code class="prettyprint">object</code></td>
<td>No</td>
<td>An object with custom key-value pairs to be assigned to the visitor. The server treats all keys and values as strings and also returns them as strings. Nested key-value pairs are not supported.</td>
</tr>
</tbody></table>
